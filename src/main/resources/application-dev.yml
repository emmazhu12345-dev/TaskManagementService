spring:
  datasource:
    url: jdbc:postgresql://localhost:5433/tmsdb_dev
    username: tmsuser
    password: tmspass
    hikari:
      maximum-pool-size: 5
      minimum-idle: 1

  flyway:
    enabled: true
    locations: classpath:db/migration   # ä¸ prod å®Œå…¨ç›¸åŒ
    baseline-on-migrate: true

  sql:
    init:
      mode: never

  data:
    redis:
      host: localhost      # å› ä¸ºæœ‰ 6379:6379 ç«¯å£æ˜ å°„
      port: 6379
      database: 0          # é»˜è®¤ 0 å³å¯ï¼Œ dev ç”¨ db 0ï¼Œprod å¯ä»¥ç”¨ db 1ï¼Œé¿å…å†²çª

  cache:
    type: redis            # å¦‚æœä½ æ‰“ç®—ç”¨ Spring Cache æŠŠå®ƒå½“ç¼“å­˜
    redis:
      time-to-live: 600000 # 10 åˆ†é’Ÿï¼ŒæŒ‰éœ€è¦æ”¹

  # ğŸ‘‰ Kafka dev
  kafka:
    bootstrap-servers: localhost:9092   # å¯¹åº” docker-compose é‡Œçš„ 9092:9092

    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
      properties:
        # ä½ å¦‚æœä¸éœ€è¦ type headersï¼Œå¯ä»¥è®¾ä¸º falseï¼›ä¿æŒç®€å•å…ˆä¸åŠ åˆ«çš„
        spring.json.add.type.headers: false

    consumer:
      # è¿™é‡Œé…ç½®ä¸€ä¸ªé»˜è®¤ group-idï¼›å…·ä½“çš„ @KafkaListener å¯ä»¥è‡ªå·± override
      group-id: tms-dev-default-group
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: "org.example.kafka.event"
        # Dev ç¯å¢ƒå¸¸ç”¨ earliestï¼Œæ–¹ä¾¿æœ¬åœ°é‡è·‘çœ‹åˆ°å†å²æ¶ˆæ¯
        spring.json.use.type.headers: false
      auto-offset-reset: earliest

    listener:
      # ç®€å•èµ·è§å…ˆç”¨ record çº§åˆ« ack
      ack-mode: record

server:
  port: 8080

logging:
  level:
    org.flywaydb: INFO
    org.springframework.security: DEBUG
